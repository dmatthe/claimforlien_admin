"use strict";

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

Dropzone.autoDiscover = false; ////////////////////////////////////////////////////////////////////////////////

var CotDropzone =
/*#__PURE__*/
function () {
  function CotDropzone(options) {
    _classCallCheck(this, CotDropzone);

    if (options != null) {
      this.render(options);
    }
  }

  _createClass(CotDropzone, [{
    key: "render",
    value: function render() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      // Merge default + preset + argument options.
      var defaultOptions = Object.assign({}, CotDropzone.defaultOptions);
      var preset = options.preset || defaultOptions.preset;

      if (typeof preset === 'string') {
        preset = CotDropzone.presets[preset];
      }

      if (preset != null) {
        defaultOptions = Object.assign(defaultOptions, preset);
      }

      for (var key in defaultOptions) {
        if (defaultOptions.hasOwnProperty(key) && !options.hasOwnProperty(key)) {
          options[key] = defaultOptions[key];
        }
      }

      if (options.acceptedFiles != null) {
        var acceptedFiles = options.acceptedFiles.split(',').map(function (acceptedFile) {
          acceptedFile = acceptedFile.trim();

          if (CotDropzone.acceptedFilesReplacement[acceptedFile] != null) {
            acceptedFile = CotDropzone.acceptedFilesReplacement[acceptedFile];
          }

          return acceptedFile;
        });
        options.acceptedFiles = acceptedFiles.join(', ');
      } // Instantiate Dropzone.


      this.dropzone = new Dropzone(options.selector, options);
    }
  }, {
    key: "addFile",
    value: function addFile(file) {
      if (this.dropzone.options.addFile == null) {
        return;
      }

      this.dropzone.options.addFile.call(this.dropzone, file);
    }
  }, {
    key: "addFiles",
    value: function addFiles() {
      var _this$dropzone$option;

      if (this.dropzone.options.addFiles == null) {
        return;
      }

      for (var _len = arguments.length, files = new Array(_len), _key = 0; _key < _len; _key++) {
        files[_key] = arguments[_key];
      }

      (_this$dropzone$option = this.dropzone.options.addFiles).call.apply(_this$dropzone$option, [this.dropzone].concat(files));
    }
  }, {
    key: "addInitialFile",
    value: function addInitialFile(file) {
      if (this.dropzone.options.addInitialFile == null) {
        return;
      }

      this.dropzone.options.addInitialFile.call(this.dropzone, file);
    }
  }, {
    key: "addInitialFiles",
    value: function addInitialFiles() {
      var _this$dropzone$option2;

      if (this.dropzone.options.addInitialFiles == null) {
        return;
      }

      for (var _len2 = arguments.length, files = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        files[_key2] = arguments[_key2];
      }

      (_this$dropzone$option2 = this.dropzone.options.addInitialFiles).call.apply(_this$dropzone$option2, [this.dropzone].concat(files));
    }
  }]);

  return CotDropzone;
}(); ////////////////////////////////////////////////////////////////////////////////


CotDropzone.defaultOptions = {
  maxFiles: 3,
  maxFilesize: 5,
  preset: 'default'
};

CotDropzone.mergeFunctions = function () {
  for (var _len3 = arguments.length, funcs = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
    funcs[_key3] = arguments[_key3];
  }

  return function () {
    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      args[_key4] = arguments[_key4];
    }

    for (var index = 0, length = funcs.length; index < length; index++) {
      if (typeof funcs[index] === 'function') {
        var _funcs$index;

        (_funcs$index = funcs[index]).call.apply(_funcs$index, [this].concat(args));
      }
    }
  };
};

CotDropzone.acceptedFilesReplacement = function () {
  var acceptedFilesReplacement = {
    'application/x-msword': ['application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.openxmlformats-officedocument.wordprocessingml.template', 'application/vnd.ms-word.document.macroEnabled.12', 'application/vnd.ms-word.template.macroEnabled.12'].join(', '),
    'application/x-msexcel': ['application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.openxmlformats-officedocument.spreadsheetml.template', 'application/vnd.ms-excel.sheet.macroEnabled.12', 'application/vnd.ms-excel.template.macroEnabled.12', 'application/vnd.ms-excel.addin.macroEnabled.12', 'application/vnd.ms-excel.sheet.binary.macroEnabled.12'].join(', '),
    'application/x-mspowerpoint': ['application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'application/vnd.openxmlformats-officedocument.presentationml.template', 'application/vnd.openxmlformats-officedocument.presentationml.slideshow', 'application/vnd.ms-powerpoint.addin.macroEnabled.12', 'application/vnd.ms-powerpoint.presentation.macroEnabled.12', 'application/vnd.ms-powerpoint.template.macroEnabled.12', 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12'].join(', ')
  };
  acceptedFilesReplacement['application/x-msdocument'] = [acceptedFilesReplacement['application/x-msword'], acceptedFilesReplacement['application/x-msexcel'], acceptedFilesReplacement['application/x-mspowerpoint']].join(', ');
  return acceptedFilesReplacement;
}(); ////////////////////////////////////////////////////////////////////////////////


CotDropzone.presets = {}; ////////////////////////////////////////////////////////////////////////////////

CotDropzone.presets.common = {
  init: function init() {
    var _this = this;

    this.deletedFiles = [];
    this.on('addedfile', function (file) {
      file.isExcess = false;
    });
    this.on('removedfile', function (file) {
      if (file.status === Dropzone.SUCCESS) {
        file.status = 'deleted';

        _this.deletedFiles.push(file);
      }
    });
    this.on('canceled', function (file) {
      if (this.options.announce == null) {
        return;
      }

      this.options.announce.call(this, file.name + ' upload canceled.');
    });
    this.on('error', function (file, errorMessage, xhr) {
      if (xhr != null) {
        file.errorType = 'uploaderror';
      }

      file.errorMessage = errorMessage;

      if (this.options.announce == null) {
        return;
      }

      this.options.announce.call(this, 'An error occured. ' + errorMessage);
    });
    this.on('maxfilesreached', function (file) {
      if (this.options.announce == null) {
        return;
      }

      this.options.announce.call(this, 'Maximum number of files reached.');
    });
    this.on('maxfilesexceeded', function (file) {
      file.isExcess = true;

      if (this.options.announce == null) {
        return;
      }

      this.options.announce.call(this, 'Maximum number of files exceeded.');
    });
    this.on('sending', function (file) {
      if (this.options.announce == null) {
        return;
      }

      this.options.announce.call(this, 'Uploading file ' + file.name + '.');
    });
    this.on('success', function (file) {
      if (this.options.announce != null) {
        return;
      }

      this.options.announce.call(this, file.name + ' uploaded.');
    });
  },
  // ---------------------------------------------------------------------------
  announce: function announce(message) {
    // Initialize announce element.
    if (this.announceElement == null) {
      this.announceElement = document.body.appendChild(document.createElement('div'));
      this.announceElement.classList.add('sr-only');
      this.announceElement.setAttribute('aria-live', 'polite');
      this.announceElement.setAttribute('aria-atomic', false);
    } // Append announcement.


    var paragraph = document.createElement('p');
    paragraph.appendChild(document.createTextNode(message));
    this.announceElement.appendChild(paragraph);
  },
  // ---------------------------------------------------------------------------
  addFile: function addFile(file) {
    file.name = file.name || 'untitled';
    file.size = file.size == null ? 0 : file.size;
    file.type = file.type || 'unknown';
    file.accepted = true; // file.isExcess = false;

    file.status = file.status || Dropzone.ADDED;

    if (file.status === 'deleted') {
      this.deletedFiles.push(file);
    } else {
      this.files.push(file);
      this.emit('addedfile', file);

      if (file.thumbnailDataUri != null) {
        this.emit('thumbnail', file, file.thumbnailDataUri);
      }

      if (file.status === Dropzone.ERROR) {
        file.accepted = false;
        this.emit('error', file, file.errorMessage || 'Error', true);
      } else if (this.options.maxFiles != null) {
        if (this.getAcceptedFiles().length === this.options.maxFiles) {
          this.emit('maxfilesreached', file);
        } else if (this.getAcceptedFiles().length > this.options.maxFiles) {
          file.accepted = false;
          file.status = Dropzone.ERROR;
          this.emit('maxfilesexceeded', file);
          this.emit('error', file, this.options.dictMaxFilesExceeded || 'Error');
        }
      }
    }
  },
  addFiles: function addFiles() {
    var _this2 = this;

    for (var _len5 = arguments.length, files = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
      files[_key5] = arguments[_key5];
    }

    if (this.options.addFile != null) {
      if (Array.isArray(files[0])) {
        files = files[0];
      }

      files.forEach(function (file) {
        _this2.options.addFile.call(_this2, file);
      });
    }
  },
  addInitialFile: function addInitialFile(file) {
    if (this.options.addFile != null) {
      file.status = file.status || Dropzone.SUCCESS;
      this.options.addFile.call(this, file);
      this.emit('processing', file);
      this.emit('complete', file);
    }
  },
  addInitialFiles: function addInitialFiles() {
    var _this3 = this;

    for (var _len6 = arguments.length, files = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
      files[_key6] = arguments[_key6];
    }

    if (this.options.addInitialFile != null) {
      if (Array.isArray(files[0])) {
        files = files[0];
      }

      files.forEach(function (file) {
        _this3.options.addInitialFile.call(_this3, file);
      });
    }
  },
  // ---------------------------------------------------------------------------
  thumbnailDataUris: function () {
    var thumbnailDataUris = {
      'default': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlIiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtZmlsZSBmYS13LTEyIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4NCA1MTIiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTM2OS45IDk3LjlMMjg2IDE0QzI3NyA1IDI2NC44LS4xIDI1Mi4xLS4xSDQ4QzIxLjUgMCAwIDIxLjUgMCA0OHY0MTZjMCAyNi41IDIxLjUgNDggNDggNDhoMjg4YzI2LjUgMCA0OC0yMS41IDQ4LTQ4VjEzMS45YzAtMTIuNy01LjEtMjUtMTQuMS0zNHpNMzMyLjEgMTI4SDI1NlY1MS45bDc2LjEgNzYuMXpNNDggNDY0VjQ4aDE2MHYxMDRjMCAxMy4zIDEwLjcgMjQgMjQgMjRoMTA0djI4OEg0OHoiPjwvcGF0aD48L3N2Zz4=',
      'text': {
        'default': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLWFsdCIgY2xhc3M9InN2Zy1pbmxpbmUtLWZhIGZhLWZpbGUtYWx0IGZhLXctMTIiIHJvbGU9ImltZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzg0IDUxMiI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNMjg4IDI0OHYyOGMwIDYuNi01LjQgMTItMTIgMTJIMTA4Yy02LjYgMC0xMi01LjQtMTItMTJ2LTI4YzAtNi42IDUuNC0xMiAxMi0xMmgxNjhjNi42IDAgMTIgNS40IDEyIDEyem0tMTIgNzJIMTA4Yy02LjYgMC0xMiA1LjQtMTIgMTJ2MjhjMCA2LjYgNS40IDEyIDEyIDEyaDE2OGM2LjYgMCAxMi01LjQgMTItMTJ2LTI4YzAtNi42LTUuNC0xMi0xMi0xMnptMTA4LTE4OC4xVjQ2NGMwIDI2LjUtMjEuNSA0OC00OCA0OEg0OGMtMjYuNSAwLTQ4LTIxLjUtNDgtNDhWNDhDMCAyMS41IDIxLjUgMCA0OCAwaDIwNC4xQzI2NC44IDAgMjc3IDUuMSAyODYgMTQuMUwzNjkuOSA5OGM5IDguOSAxNC4xIDIxLjIgMTQuMSAzMy45em0tMTI4LTgwVjEyOGg3Ni4xTDI1NiA1MS45ek0zMzYgNDY0VjE3NkgyMzJjLTEzLjMgMC0yNC0xMC43LTI0LTI0VjQ4SDQ4djQxNmgyODh6Ij48L3BhdGg+PC9zdmc+'
      },
      'image': {
        'default': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLWltYWdlIiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtZmlsZS1pbWFnZSBmYS13LTEyIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4NCA1MTIiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTM2OS45IDk3LjlMMjg2IDE0QzI3NyA1IDI2NC44LS4xIDI1Mi4xLS4xSDQ4QzIxLjUgMCAwIDIxLjUgMCA0OHY0MTZjMCAyNi41IDIxLjUgNDggNDggNDhoMjg4YzI2LjUgMCA0OC0yMS41IDQ4LTQ4VjEzMS45YzAtMTIuNy01LjEtMjUtMTQuMS0zNHpNMzMyLjEgMTI4SDI1NlY1MS45bDc2LjEgNzYuMXpNNDggNDY0VjQ4aDE2MHYxMDRjMCAxMy4zIDEwLjcgMjQgMjQgMjRoMTA0djI4OEg0OHptMzItNDhoMjI0VjI4OGwtMjMuNS0yMy41Yy00LjctNC43LTEyLjMtNC43LTE3IDBMMTc2IDM1MmwtMzkuNS0zOS41Yy00LjctNC43LTEyLjMtNC43LTE3IDBMODAgMzUydjY0em00OC0yNDBjLTI2LjUgMC00OCAyMS41LTQ4IDQ4czIxLjUgNDggNDggNDggNDgtMjEuNSA0OC00OC0yMS41LTQ4LTQ4LTQ4eiI+PC9wYXRoPjwvc3ZnPg=='
      },
      'audio': {
        'default': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLWF1ZGlvIiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtZmlsZS1hdWRpbyBmYS13LTEyIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4NCA1MTIiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTM2OS45NDEgOTcuOTQxbC04My44ODItODMuODgyQTQ4IDQ4IDAgMCAwIDI1Mi4xMTggMEg0OEMyMS40OSAwIDAgMjEuNDkgMCA0OHY0MTZjMCAyNi41MSAyMS40OSA0OCA0OCA0OGgyODhjMjYuNTEgMCA0OC0yMS40OSA0OC00OFYxMzEuODgyYTQ4IDQ4IDAgMCAwLTE0LjA1OS0zMy45NDF6TTMzMi4xMTggMTI4SDI1NlY1MS44ODJMMzMyLjExOCAxMjh6TTQ4IDQ2NFY0OGgxNjB2MTA0YzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNGgxMDR2Mjg4SDQ4em0xNDQtNzYuMDI0YzAgMTAuNjkxLTEyLjkyNiAxNi4wNDUtMjAuNDg1IDguNDg1TDEzNiAzNjAuNDg2aC0yOGMtNi42MjcgMC0xMi01LjM3My0xMi0xMnYtNTZjMC02LjYyNyA1LjM3My0xMiAxMi0xMmgyOGwzNS41MTUtMzYuOTQ3YzcuNTYtNy41NiAyMC40ODUtMi4yMDYgMjAuNDg1IDguNDg1djEzNS45NTJ6bTQxLjIwMS00Ny4xM2M5LjA1MS05LjI5NyA5LjA2LTI0LjEzMy4wMDEtMzMuNDM5LTIyLjE0OS0yMi43NTIgMTIuMjM1LTU2LjI0NiAzNC4zOTUtMzMuNDgxIDI3LjE5OCAyNy45NCAyNy4yMTIgNzIuNDQ0LjAwMSAxMDAuNDAxLTIxLjc5MyAyMi4zODYtNTYuOTQ3LTEwLjMxNS0zNC4zOTctMzMuNDgxeiI+PC9wYXRoPjwvc3ZnPg=='
      },
      'video': {
        'default': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLXZpZGVvIiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtZmlsZS12aWRlbyBmYS13LTEyIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4NCA1MTIiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTM2OS45NDEgOTcuOTQxbC04My44ODItODMuODgyQTQ4IDQ4IDAgMCAwIDI1Mi4xMTggMEg0OEMyMS40OSAwIDAgMjEuNDkgMCA0OHY0MTZjMCAyNi41MSAyMS40OSA0OCA0OCA0OGgyODhjMjYuNTEgMCA0OC0yMS40OSA0OC00OFYxMzEuODgyYTQ4IDQ4IDAgMCAwLTE0LjA1OS0zMy45NDF6TTMzMi4xMTggMTI4SDI1NlY1MS44ODJMMzMyLjExOCAxMjh6TTQ4IDQ2NFY0OGgxNjB2MTA0YzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNGgxMDR2Mjg4SDQ4em0yMjguNjg3LTIxMS4zMDNMMjI0IDMwNS4zNzRWMjY4YzAtMTEuMDQ2LTguOTU0LTIwLTIwLTIwSDEwMGMtMTEuMDQ2IDAtMjAgOC45NTQtMjAgMjB2MTA0YzAgMTEuMDQ2IDguOTU0IDIwIDIwIDIwaDEwNGMxMS4wNDYgMCAyMC04Ljk1NCAyMC0yMHYtMzcuMzc0bDUyLjY4NyA1Mi42NzRDMjg2LjcwNCAzOTcuMzE4IDMwNCAzOTAuMjggMzA0IDM3NS45ODZWMjY0LjAxMWMwLTE0LjMxMS0xNy4zMDktMjEuMzE5LTI3LjMxMy0xMS4zMTR6Ij48L3BhdGg+PC9zdmc+'
      },
      'application': {
        'msword': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLXdvcmQiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1maWxlLXdvcmQgZmEtdy0xMiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzODQgNTEyIj48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0zNjkuOSA5Ny45TDI4NiAxNEMyNzcgNSAyNjQuOC0uMSAyNTIuMS0uMUg0OEMyMS41IDAgMCAyMS41IDAgNDh2NDE2YzAgMjYuNSAyMS41IDQ4IDQ4IDQ4aDI4OGMyNi41IDAgNDgtMjEuNSA0OC00OFYxMzEuOWMwLTEyLjctNS4xLTI1LTE0LjEtMzR6TTMzMi4xIDEyOEgyNTZWNTEuOWw3Ni4xIDc2LjF6TTQ4IDQ2NFY0OGgxNjB2MTA0YzAgMTMuMyAxMC43IDI0IDI0IDI0aDEwNHYyODhINDh6bTIyMC4xLTIwOGMtNS43IDAtMTAuNiA0LTExLjcgOS41LTIwLjYgOTcuNy0yMC40IDk1LjQtMjEgMTAzLjUtLjItMS4yLS40LTIuNi0uNy00LjMtLjgtNS4xLjMuMi0yMy42LTk5LjUtMS4zLTUuNC02LjEtOS4yLTExLjctOS4yaC0xMy4zYy01LjUgMC0xMC4zIDMuOC0xMS43IDkuMS0yNC40IDk5LTI0IDk2LjItMjQuOCAxMDMuNy0uMS0xLjEtLjItMi41LS41LTQuMi0uNy01LjItMTQuMS03My4zLTE5LjEtOTktMS4xLTUuNi02LTkuNy0xMS44LTkuN2gtMTYuOGMtNy44IDAtMTMuNSA3LjMtMTEuNyAxNC44IDggMzIuNiAyNi43IDEwOS41IDMzLjIgMTM2IDEuMyA1LjQgNi4xIDkuMSAxMS43IDkuMWgyNS4yYzUuNSAwIDEwLjMtMy43IDExLjYtOS4xbDE3LjktNzEuNGMxLjUtNi4yIDIuNS0xMiAzLTE3LjNsMi45IDE3LjNjLjEuNCAxMi42IDUwLjUgMTcuOSA3MS40IDEuMyA1LjMgNi4xIDkuMSAxMS42IDkuMWgyNC43YzUuNSAwIDEwLjMtMy43IDExLjYtOS4xIDIwLjgtODEuOSAzMC4yLTExOSAzNC41LTEzNiAxLjktNy42LTMuOC0xNC45LTExLjYtMTQuOWgtMTUuOHoiPjwvcGF0aD48L3N2Zz4=',
        'vnd.ms-excel': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLWV4Y2VsIiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtZmlsZS1leGNlbCBmYS13LTEyIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDM4NCA1MTIiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTM2OS45IDk3LjlMMjg2IDE0QzI3NyA1IDI2NC44LS4xIDI1Mi4xLS4xSDQ4QzIxLjUgMCAwIDIxLjUgMCA0OHY0MTZjMCAyNi41IDIxLjUgNDggNDggNDhoMjg4YzI2LjUgMCA0OC0yMS41IDQ4LTQ4VjEzMS45YzAtMTIuNy01LjEtMjUtMTQuMS0zNHpNMzMyLjEgMTI4SDI1NlY1MS45bDc2LjEgNzYuMXpNNDggNDY0VjQ4aDE2MHYxMDRjMCAxMy4zIDEwLjcgMjQgMjQgMjRoMTA0djI4OEg0OHptMjEyLTI0MGgtMjguOGMtNC40IDAtOC40IDIuNC0xMC41IDYuMy0xOCAzMy4xLTIyLjIgNDIuNC0yOC42IDU3LjctMTMuOS0yOS4xLTYuOS0xNy4zLTI4LjYtNTcuNy0yLjEtMy45LTYuMi02LjMtMTAuNi02LjNIMTI0Yy05LjMgMC0xNSAxMC0xMC40IDE4bDQ2LjMgNzgtNDYuMyA3OGMtNC43IDggMS4xIDE4IDEwLjQgMThoMjguOWM0LjQgMCA4LjQtMi40IDEwLjUtNi4zIDIxLjctNDAgMjMtNDUgMjguNi01Ny43IDE0LjkgMzAuMiA1LjkgMTUuOSAyOC42IDU3LjcgMi4xIDMuOSA2LjIgNi4zIDEwLjYgNi4zSDI2MGM5LjMgMCAxNS0xMCAxMC40LTE4TDIyNCAzMjBjLjctMS4xIDMwLjMtNTAuNSA0Ni4zLTc4IDQuNy04LTEuMS0xOC0xMC4zLTE4eiI+PC9wYXRoPjwvc3ZnPg==',
        'vnd.ms-powerpoint': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLXBvd2VycG9pbnQiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1maWxlLXBvd2VycG9pbnQgZmEtdy0xMiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzODQgNTEyIj48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0zNjkuOSA5Ny45TDI4NiAxNEMyNzcgNSAyNjQuOC0uMSAyNTIuMS0uMUg0OEMyMS41IDAgMCAyMS41IDAgNDh2NDE2YzAgMjYuNSAyMS41IDQ4IDQ4IDQ4aDI4OGMyNi41IDAgNDgtMjEuNSA0OC00OFYxMzEuOWMwLTEyLjctNS4xLTI1LTE0LjEtMzR6TTMzMi4xIDEyOEgyNTZWNTEuOWw3Ni4xIDc2LjF6TTQ4IDQ2NFY0OGgxNjB2MTA0YzAgMTMuMyAxMC43IDI0IDI0IDI0aDEwNHYyODhINDh6bTcyLTYwVjIzNmMwLTYuNiA1LjQtMTIgMTItMTJoNjkuMmMzNi43IDAgNjIuOCAyNyA2Mi44IDY2LjMgMCA3NC4zLTY4LjcgNjYuNS05NS41IDY2LjVWNDA0YzAgNi42LTUuNCAxMi0xMiAxMkgxMzJjLTYuNiAwLTEyLTUuNC0xMi0xMnptNDguNS04Ny40aDIzYzcuOSAwIDEzLjktMi40IDE4LjEtNy4yIDguNS05LjggOC40LTI4LjUuMS0zNy44LTQuMS00LjYtOS45LTctMTcuNC03aC0yMy45djUyeiI+PC9wYXRoPjwvc3ZnPg==',
        'pdf': 'data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJmaWxlLXBkZiIgY2xhc3M9InN2Zy1pbmxpbmUtLWZhIGZhLWZpbGUtcGRmIGZhLXctMTIiIHJvbGU9ImltZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzg0IDUxMiI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNMzY5LjkgOTcuOUwyODYgMTRDMjc3IDUgMjY0LjgtLjEgMjUyLjEtLjFINDhDMjEuNSAwIDAgMjEuNSAwIDQ4djQxNmMwIDI2LjUgMjEuNSA0OCA0OCA0OGgyODhjMjYuNSAwIDQ4LTIxLjUgNDgtNDhWMTMxLjljMC0xMi43LTUuMS0yNS0xNC4xLTM0ek0zMzIuMSAxMjhIMjU2VjUxLjlsNzYuMSA3Ni4xek00OCA0NjRWNDhoMTYwdjEwNGMwIDEzLjMgMTAuNyAyNCAyNCAyNGgxMDR2Mjg4SDQ4em0yNTAuMi0xNDMuN2MtMTIuMi0xMi00Ny04LjctNjQuNC02LjUtMTcuMi0xMC41LTI4LjctMjUtMzYuOC00Ni4zIDMuOS0xNi4xIDEwLjEtNDAuNiA1LjQtNTYtNC4yLTI2LjItMzcuOC0yMy42LTQyLjYtNS45LTQuNCAxNi4xLS40IDM4LjUgNyA2Ny4xLTEwIDIzLjktMjQuOSA1Ni0zNS40IDc0LjQtMjAgMTAuMy00NyAyNi4yLTUxIDQ2LjItMy4zIDE1LjggMjYgNTUuMiA3Ni4xLTMxLjIgMjIuNC03LjQgNDYuOC0xNi41IDY4LjQtMjAuMSAxOC45IDEwLjIgNDEgMTcgNTUuOCAxNyAyNS41IDAgMjgtMjguMiAxNy41LTM4Ljd6bS0xOTguMSA3Ny44YzUuMS0xMy43IDI0LjUtMjkuNSAzMC40LTM1LTE5IDMwLjMtMzAuNCAzNS43LTMwLjQgMzV6bTgxLjYtMTkwLjZjNy40IDAgNi43IDMyLjEgMS44IDQwLjgtNC40LTEzLjktNC4zLTQwLjgtMS44LTQwLjh6bS0yNC40IDEzNi42YzkuNy0xNi45IDE4LTM3IDI0LjctNTQuNyA4LjMgMTUuMSAxOC45IDI3LjIgMzAuMSAzNS41LTIwLjggNC4zLTM4LjkgMTMuMS01NC44IDE5LjJ6bTEzMS42LTVzLTUgNi0zNy4zLTcuOGMzNS4xLTIuNiA0MC45IDUuNCAzNy4zIDcuOHoiPjwvcGF0aD48L3N2Zz4='
      }
    };
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.wordprocessingml.document'] = thumbnailDataUris['application']['msword'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.wordprocessingml.template'] = thumbnailDataUris['application']['msword'];
    thumbnailDataUris['application']['vnd.ms-word.document.macroEnabled.12'] = thumbnailDataUris['application']['msword'];
    thumbnailDataUris['application']['vnd.ms-word.template.macroEnabled.12'] = thumbnailDataUris['application']['msword'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.spreadsheetml.sheet'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.spreadsheetml.template'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.ms-excel.sheet.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.ms-excel.template.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.ms-excel.addin.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.ms-excel.sheet.binary.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-excel'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.presentationml.presentation'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.presentationml.template'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.openxmlformats-officedocument.presentationml.slideshow'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.ms-powerpoint.addin.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.ms-powerpoint.presentation.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.ms-powerpoint.template.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    thumbnailDataUris['application']['vnd.ms-powerpoint.slideshow.macroEnabled.12'] = thumbnailDataUris['application']['vnd.ms-powerpoint'];
    return thumbnailDataUris;
  }()
}; ////////////////////////////////////////////////////////////////////////////////

CotDropzone.presets["default"] = {
  autoQueue: false,
  thumbnailHeight: 48,
  thumbnailWidth: 48,
  previewTemplate:
  /* html */
  "\n    <div class=\"dz-preview dz-file-preview\">\n      <div class=\"dz-left\">\n        <img data-dz-thumbnail />\n      </div>\n\n      <div class=\"dz-middle\">\n        <div class=\"dz-details\">\n          <div class=\"dz-filename\"><span data-dz-name></span> <span data-dz-size></span></div>\n        </div>\n\n        <div class=\"dz-status\">\n          <div class=\"progress progress-striped active\" role=\"progressbar\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\">\n            <div class=\"progress-bar progress-bar-success\" data-dz-uploadprogress></div>\n          </div>\n\n          <div class=\"dz-error-message\">\n            <span data-dz-errormessage></span>\n          </div>\n\n          <div class=\"dz-success-message\"></div>\n        </div>\n\n        <div class=\"dz-fields\"></div>\n      </div>\n\n      <div class=\"dz-right\">\n        <button type=\"button\" class=\"btn btn-block btn-primary btn-upload\">\n          <span>Upload<span class=\"sr-only\"> <span data-dz-name></span></span></span>\n        </button>\n\n        <button type=\"button\" data-dz-remove class=\"btn btn-block btn-warning btn-cancel\">\n          <span>Cancel<span class=\"sr-only\"> <span data-dz-name></span></span></span>\n        </button>\n\n        <button type=\"button\" data-dz-remove class=\"btn btn-block btn-danger btn-delete\">\n          <span>Delete<span class=\"sr-only\"> <span data-dz-name></span></span></span>\n        </button>\n      </div>\n    </div>\n  ",
  init: CotDropzone.mergeFunctions(CotDropzone.presets.common.init, function () {
    var _this4 = this;

    // this.options = JSON.JSON.stringify();
    // Add fields to preview template.
    if (this.options.getFieldsTemplate != null) {
      this.options.previewTemplate = this.options.previewTemplate.replace('<div class="dz-fields"></div>', "<div class=\"dz-fields\">".concat(this.options.getFieldsTemplate.call(this), "</div>"));
    } // Customize dropzone element with user interface.


    this.element.classList.add('dz-preset-default');
    this.element.innerHTML =
    /* html */
    "\n      <div class=\"dz-description\"></div>\n      <div class=\"dz-buttons-top\">\n        <button type=\"button\" class=\"btn btn-default btn-addFiles\">Add File</button>\n        <button type=\"button\" class=\"btn btn-default btn-startFileUpload\">Start File Upload</button>\n      </div>\n      <div class=\"previewsContainer\"></div>\n      <div class=\"dz-buttons-bottom\">\n        <button type=\"button\" class=\"btn btn-default btn-addFiles\">Add File</button>\n        <button type=\"button\" class=\"btn btn-default btn-startFileUpload\">Start File Upload</button>\n      </div>\n    ";
    this.previewsContainer = this.options.previewsContainer = this.element.querySelector('.previewsContainer');
    var addFilesButtons = this.element.querySelectorAll('.btn-addFiles');

    for (var index = 0, length = addFilesButtons.length; index < length; index++) {
      var button = addFilesButtons[index];
      button.addEventListener('click', function (event) {
        event.preventDefault();

        _this4.hiddenFileInput.click();
      });
    }

    var startFileUploadButtons = this.element.querySelectorAll('.btn-startFileUpload');

    for (var _index = 0, _length = startFileUploadButtons.length; _index < _length; _index++) {
      var _button = startFileUploadButtons[_index];

      _button.addEventListener('click', function (event) {
        event.preventDefault();

        _this4.enqueueFiles(_this4.getFilesWithStatus(Dropzone.ADDED));
      });
    } // Add descriptions base on options.


    var descriptions = [];

    if (this.options.acceptedFiles != null) {
      var acceptedFiles = this.options.acceptedFiles.split(',').map(function (value) {
        return value.trim().toLowerCase();
      });
      var fileTypes = [];

      for (var _index2 = 0, _length2 = acceptedFiles.length; _index2 < _length2; _index2++) {
        if (acceptedFiles[_index2].indexOf('/') !== -1) {
          if (acceptedFiles[_index2].indexOf('/*') !== -1) {
            fileTypes.push("".concat(acceptedFiles[_index2].substring(0, acceptedFiles[_index2].indexOf('/*')), " files"));
          } else if (acceptedFiles[_index2] === 'application/msword' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.wordprocessingml.template' || acceptedFiles[_index2] === 'application/vnd.ms-word.document.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-word.template.macroenabled.12') {
            fileTypes.push('Microsoft Word documents');
          } else if (acceptedFiles[_index2] === 'application/vnd.ms-excel' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.spreadsheetml.template' || acceptedFiles[_index2] === 'application/vnd.ms-excel.sheet.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-excel.template.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-excel.addin.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-excel.sheet.binary.macroenabled.12') {
            fileTypes.push('Microsoft Excel spreadsheets');
          } else if (acceptedFiles[_index2] === 'application/vnd.ms-powerpoint' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.presentationml.presentation' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.presentationml.template' || acceptedFiles[_index2] === 'application/vnd.openxmlformats-officedocument.presentationml.slideshow' || acceptedFiles[_index2] === 'application/vnd.ms-powerpoint.addin.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-powerpoint.presentation.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-powerpoint.template.macroenabled.12' || acceptedFiles[_index2] === 'application/vnd.ms-powerpoint.slideshow.macroenabled.12') {
            fileTypes.push('Microsoft Powerpoint documents');
          } else {
            fileTypes.push(acceptedFiles[_index2].substring(acceptedFiles[_index2].indexOf('/') + 1));
          }
        } else {
          fileTypes.push(acceptedFiles[_index2] + ' files');
        }
      }

      fileTypes = fileTypes.filter(function (fileType, index, array) {
        return array.indexOf(fileType) === index;
      });
      var totalFileTypes = fileTypes.length;
      var lastFileType;

      if (fileTypes.length > 1) {
        lastFileType = fileTypes.pop();
      }

      var fileTypesString = fileTypes.join(', ');

      if (lastFileType) {
        fileTypesString = [fileTypesString, lastFileType].join(' or ');
      }

      descriptions.push("Only the following files are allowed: ".concat(fileTypesString, "."));
    }

    if (this.options.maxFiles != null) {
      descriptions.push("Maximum ".concat(this.options.maxFiles, " uploaded file").concat(+this.options.maxFiles === 1 ? '' : 's', "."));
    }

    if (this.options.maxFilesize != null) {
      descriptions.push("Maximum size for file attachment is ".concat(this.options.maxFilesize, " MB."));
    }

    if (descriptions.length > 0) {
      var paragraph = document.createElement('p');
      paragraph.appendChild(document.createTextNode(descriptions.join(' ')));
      this.element.querySelector('.dz-description').appendChild(paragraph);
    } // Function for updating the dropzone element based on status.


    var updateElement = function updateElement() {
      // Update bottom button display.
      if (_this4.files.length > 0) {
        _this4.element.classList.add('dz-files-exists');
      } else {
        _this4.element.classList.remove('dz-files-exists');
      } // Update start file upload buttons state.


      if (_this4.getFilesWithStatus(Dropzone.ADDED).length > 0) {
        for (var _index3 = 0, _length3 = startFileUploadButtons.length; _index3 < _length3; _index3++) {
          var _button2 = startFileUploadButtons[_index3];

          _button2.removeAttribute('disabled');
        }
      } else {
        for (var _index4 = 0, _length4 = startFileUploadButtons.length; _index4 < _length4; _index4++) {
          var _button3 = startFileUploadButtons[_index4];

          _button3.setAttribute('disabled', '');
        }
      }
    };

    updateElement(); // ---

    var row = 0;
    this.on('addedfile', function (file) {
      file.fields = file.fields || {}; // Complete preview template.

      file.previewElement.querySelector('.btn-upload').addEventListener('click', function (event) {
        _this4.enqueueFile(file);
      }); // Complete fields template

      if (_this4.options.setFieldsTemplate != null) {
        _this4.options.setFieldsTemplate.call(_this4, file, row);
      }

      row = row + 1; // Add generic thumbnail.

      if (file.dataURL == null) {
        var thumbnailSrc;

        if (file.thumbnailDataUri != null) {
          thumbnailSrc = file.thumbnailDataUri;
        } else if (file.type) {
          var mimeTypes = file.type.split('/');
          var mainType = _this4.options.thumbnailDataUris && _this4.options.thumbnailDataUris[mimeTypes[0]];

          if (mainType == null) {
            mainType = _this4.options.thumbnailDataUris["default"];
          } else {
            thumbnailSrc = mainType[mimeTypes[1]] || mainType["default"];
          }

          if (thumbnailSrc == null) {
            thumbnailSrc = _this4.options.thumbnailDataUris["default"];
          }
        } else {
          thumbnailSrc = _this4.options.thumbnailDataUris["default"];
        }

        var thumbnailElement = file.previewElement.querySelector('[data-dz-thumbnail]');
        thumbnailElement.setAttribute('src', thumbnailSrc);

        if (_this4.options.thumbnailWidth) {
          thumbnailElement.style.width = "".concat(+_this4.options.thumbnailWidth, "px");
        }
      }

      updateElement();

      if (_this4.options.setLink != null) {
        _this4.options.setLink.call(_this4, file);
      }
    });
    this.on('removedfile', function (file) {
      var filesToReinsert = _this4.files.filter(function (file) {
        return file.status === Dropzone.ERROR && file.isExcess === true;
      });

      if (filesToReinsert.length > 0) {
        var _this4$options$addFil;

        filesToReinsert.forEach(function (file) {
          file.status = Dropzone.ADDED;
          file.status.isExcess = false;
          file.previewElement.querySelector('[data-dz-errormessage]').innerHTML = '';
        });
        filesToReinsert.forEach(function (file) {
          _this4.removeFile(file);
        });

        (_this4$options$addFil = _this4.options.addFiles).call.apply(_this4$options$addFil, [_this4].concat(_toConsumableArray(filesToReinsert)));
      }

      updateElement();
    }); // ---

    this.on('thumbnail', function (file, datauri) {
      file.thumbnailDataUri = datauri;
    }); // ---

    this.on('sending', function (file, xhr, formData) {
      if (typeof _this4.options.getSid === 'function') {
        var sid = _this4.options.getSid.call(_this4);

        if (sid != null && sid != false && xhr.authSet !== true) {
          xhr.setRequestHeader('Authorization', sid);
          xhr.authSet == true;
        }
      }

      if (typeof _this4.options.beforeSend === 'function') {
        _this4.options.beforeSend.call(_this4, xhr, file, formData);
      }
    });
    this.on('success', function (file) {
      if (file.xhr && file.xhr.responseText) {
        try {
          var json = JSON.parse(file.xhr.responseText);

          if (json.BIN_ID && json.BIN_ID[0]) {
            if (json.BIN_ID[0].bin_id || json.BIN_ID[0].file_name) {
              if (json.BIN_ID[0].bin_id) {
                file.bin_id = json.BIN_ID[0].bin_id;
              }

              if (json.BIN_ID[0].file_name) {
                file.file_name = json.BIN_ID[0].file_name;
              }
            } else {
              file.bin_id = json.BIN_ID[0];
            }
          }

          if (json.FILE_NAME) {
            file.file_name = json.FILE_NAME[0];
          }

          if (json.FILE_PATH) {
            file.file_path = json.FILE_PATH;
          }

          file.uploadDate = new Date().toISOString();
        } catch (error) {
          // Do nothing.
          console.error(error);
        }
      }

      file.previewElement.querySelector('.dz-success-message').appendChild(document.createTextNode('File upload successful.'));

      if (this.options.setLink != null) {
        this.options.setLink.call(this, file);
      }
    });
    this.on('complete', function (file) {
      updateElement();
    });
  }),
  // ---------------------------------------------------------------------------
  announce: CotDropzone.presets.common.announce,
  thumbnailDataUris: CotDropzone.presets.common.thumbnailDataUris,
  // ---------------------------------------------------------------------------
  fields: [],
  onFieldChange: function onFieldChange(file, files) {},
  getFieldsTemplate: function getFieldsTemplate() {
    var getFieldTemplate = function getFieldTemplate(field) {
      if (field == null) {
        return '';
      }

      var fieldString;

      switch (field.type) {
        case 'textarea':
          fieldString =
          /* html */
          "<textarea title=\"".concat(field.title, "\" aria-required=\"").concat(field.required === true ? 'true' : 'false', "\" class=\"form-control").concat(field.required === true ? ' required' : '', "\" placeholder=\"").concat(field.placeholder || '', "\" row=\"").concat(field.row || '', "\" col=\"").concat(field.col || '', "\"></textarea>");
          break;

        default:
          fieldString =
          /* html */
          "<input title=\"".concat(field.title, "\" type=\"").concat(field.type || 'text', "\" aria-required=\"").concat(field.required === true ? 'true' : 'false', "\" class=\"form-control").concat(field.required === true ? ' required' : '', "\" placeholder=\"").concat(field.placeholder || '', "\"></input>");
      }

      return (
        /* html */
        "\n        <div class=\"row\">\n          <div data-name=\"".concat(field.name, "\" class=\"col-xs-12 form-group form-group-vertical has-feedback\">\n            <div>\n              <label class=\"control-label\">\n                <span>").concat(field.title, "</span>\n                ").concat(field.required !== true ? '<span class="optional">(optional)</span>' : '', "\n              </label>\n              ").concat(field.prehelptext != null ? '<p class="helptext prehelptext">' + field.prehelptext + '</p>' : '', "\n              <div class=\"entryField\">\n                ").concat(fieldString, "\n              </div>\n              ").concat(field.posthelptext != null ? '<p class="helptext posthelptext">' + field.posthelptext + '</p>' : '', "\n            </div>\n          </div>\n        </div>\n      ")
      );
    }; // Add fields to preview template.


    if (this.options.fields == null) {
      this.options.fields = [];
    }

    var template = '';
    this.options.fields.forEach(function (field) {
      template = template + getFieldTemplate(field);
    });
    return template;
  },
  setFieldsTemplate: function setFieldsTemplate(file, row) {
    var _this5 = this;

    var setFieldTemplate = function setFieldTemplate(field) {
      var name = "".concat(field.name || field.id, "_").concat(row);
      var formGroup = file.previewElement.querySelector("[data-name=\"".concat(field.name || field.id, "\"]"));
      formGroup.setAttribute('id', "".concat(name, "Element"));
      formGroup.getElementsByTagName('label')[0].setAttribute('for', name);
      var describedBy = [];

      if (field.prehelptext != null) {
        var id = "prehelptext_".concat(name);
        formGroup.querySelector('.prehelptext').setAttribute('id', id);
        describedBy.push(id);
      }

      if (field.posthelptext != null) {
        var _id = "posthelptext_".concat(name);

        formGroup.querySelector('.posthelptext').setAttribute('id', _id);
        describedBy.push(_id);
      }

      var element;

      switch (field.type) {
        case 'textarea':
          element = formGroup.getElementsByTagName('textarea')[0];
          break;

        default:
          element = formGroup.getElementsByTagName('input')[0];
      }

      element.setAttribute('id', name);
      element.setAttribute('name', name);

      if (describedBy.length > 0) {
        element.setAttribute('aria-describedby', describedBy.join(' '));
      }

      if (fv) {
        var elementValidator = field.validator || {};

        if (field.required) {
          elementValidator.notEmpty = {
            message: field.title + ' is required.'
          };
        }

        fv.addField(name, {
          validators: elementValidator
        });
      }

      if (file.fields[field.name] == null) {// file.fields[field.name] = null;
      } else {
        element.value = file.fields[field.name];
      }

      $(element).change(function (event) {
        if (event.currentTarget.value != null && event.currentTarget.value != '') {
          file.fields[field.name] = event.currentTarget.value;
        } else {
          delete file.fields[field.name];
        }

        if (_this5.options.onFieldChange != null) {
          _this5.options.onFieldChange(file, _this5.files);
        }
      });
    };

    var fv;
    var $form = $(file.previewElement).closest('form');

    if ($form.length > 0) {
      fv = $form.data('formValidation');
    }

    this.options.fields = this.options.fields || [];
    this.options.fields.forEach(function (field) {
      setFieldTemplate(field);
    });
  },
  // ---------------------------------------------------------------------------
  getSid: function getSid() {
    return false;
  },
  getNasLink: function getNasLink(file) {
    return file.file_path + '/' + file.file_name;
  },
  getLink: function getLink(file) {
    if (file.bin_id || file.file_name && file.file_path) {
      var url;

      if (file.bin_id) {
        if (this.options.url.indexOf('/cc_sr_admin_v1/upload/') !== -1) {
          // V1
          url = this.options.url.substring(0, this.options.url.lastIndexOf('/') + 1) + file.bin_id;
        } else {
          // V2
          url = this.options.url.replace(/\/upload\/([^/]*)\/([^/]*)/, '/retrieve/$1/') + file.bin_id;
        }
      } else {
        // NAS
        if (this.options.getNasLink != null) {
          url = this.options.getNasLink.call(this, file);
        }
      }

      var sid;

      if (this.options.getSid != null) {
        sid = this.options.getSid.call(this);
      }

      if (sid != null && sid != false) {
        url += '?sid=' + sid;
      }

      return url || false;
    } else {
      return false;
    }
  },
  setLink: function setLink(file) {
    var link;

    if (this.options.getLink != null) {
      link = this.options.getLink.call(this, file);
    }

    if (link != null && link != false) {
      if (!(link instanceof jQuery) && link.nodeType !== 1) {
        var href = link;
        link = document.createElement('a');
        link.setAttribute('href', href);
      }

      var $link = $(link);
      $('[data-dz-thumbnail], .dz-filename > [data-dz-name]', file.previewElement).wrap($link);
    }
  },
  // ---------------------------------------------------------------------------
  addFile: CotDropzone.presets.common.addFile,
  addFiles: CotDropzone.presets.common.addFiles,
  addInitialFile: CotDropzone.presets.common.addInitialFile,
  addInitialFiles: CotDropzone.presets.common.addInitialFiles,
  // ---------------------------------------------------------------------------
  valueMapFromFiles: function valueMapFromFiles(_ref) {
    var name = _ref.name,
        size = _ref.size,
        type = _ref.type,
        fields = _ref.fields,
        status = _ref.status,
        bin_id = _ref.bin_id,
        file_name = _ref.file_name,
        file_path = _ref.file_path,
        uploadDate = _ref.uploadDate,
        errorMessage = _ref.errorMessage,
        errorType = _ref.errorType;
    return {
      name: name,
      size: size,
      type: type,
      fields: fields,
      status: status,
      bin_id: bin_id,
      file_name: file_name,
      file_path: file_path,
      uploadDate: uploadDate,
      errorMessage: errorMessage,
      errorType: errorType
    };
  },
  valueMapToFiles: function valueMapToFiles(_ref2) {
    var name = _ref2.name,
        size = _ref2.size,
        type = _ref2.type,
        fields = _ref2.fields,
        status = _ref2.status,
        bin_id = _ref2.bin_id,
        file_name = _ref2.file_name,
        file_path = _ref2.file_path,
        uploadDate = _ref2.uploadDate,
        errorMessage = _ref2.errorMessage,
        errorType = _ref2.errorType;
    return {
      name: name,
      size: size,
      type: type,
      fields: fields,
      status: status,
      bin_id: bin_id,
      file_name: file_name,
      file_path: file_path,
      uploadDate: uploadDate,
      errorMessage: errorMessage,
      errorType: errorType
    };
  }
};