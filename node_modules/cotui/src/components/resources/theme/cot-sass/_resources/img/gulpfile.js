var concat = require('gulp-concat'),
gulp = require('gulp'),
minify = require('gulp-clean-css'),
pleeease = require('gulp-pleeease'),
pleeeaseOptions = {
	autoprefixer: {
		browsers: [ // Match Bootstrap 3
			"Android 2.3",
			"Android >= 4",
			"Chrome >= 20",
			"Firefox >= 24",
			"Explorer >= 8",
			"iOS >= 6",
			"Opera >= 12",
			"Safari >= 6"
		], cascade: false
	},
	import: true,
	minifier: {
		removeAllComments: true
	},
	rem: false,
	sourcemaps: false
},
sass = require('gulp-sass'),
uglify = require('gulp-uglify');

// Build Javascript
gulp.task('concat', function() {
  gulp.src([
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/affix.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/alert.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/button.js',
  	'node_modules/bootstrap-sass/assets/javascripts/bootstrap/carousel.js',
  	'node_modules/bootstrap-sass/assets/javascripts/bootstrap/collapse.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/dropdown.js',
  	'node_modules/bootstrap-sass/assets/javascripts/bootstrap/modal.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/popover.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/scrollspy.js',
  	'node_modules/bootstrap-sass/assets/javascripts/bootstrap/tab.js',
  	// 'node_modules/bootstrap-sass/assets/javascripts/bootstrap/tooltip.js',
  	'node_modules/bootstrap-sass/assets/javascripts/bootstrap/transition.js',
  	'assets/js/**/*.js'
  ])
  .pipe(concat('scripts.min.js'))
  .pipe(uglify())
  .pipe(gulp.dest('assets/'))
});

// Watch styles and scripts
gulp.task('default', function() {
	gulp.watch('assets/css/*.scss',['styles']);
	gulp.watch('assets/js/scripts.js', ['concat']);
});

// Build CSS
gulp.task('styles', function() {
	gulp.src('assets/css/*.scss')
		.pipe(sass())
		.pipe(pleeease(pleeeaseOptions))
		.pipe(gulp.dest('assets/')
	);
});